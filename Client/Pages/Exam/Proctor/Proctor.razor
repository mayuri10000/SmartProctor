@namespace SmartProctor.Client.Pages.Exam
@page "/Exam/Proctor/{ExamId}"
@layout EmptyLayout

<BasicLayout
    Title="@(_examDetails?.Name ?? "")"
    MenuRender="false"
    Logo="_logo">
    <RightContentRender>
        <RightContentProctor ExamId="_examId"/>
    </RightContentRender>
    <ChildContent>
        @for (var r = 0; r < (_testTakers.Count / NUM_COLS) + 1; r++)
        {
            var row = r;
            <Row>
                @for (var c = 0; c < NUM_COLS; c++)
                {
                    var col = c;
                    var index = row * NUM_COLS + col;
                    if (_examTakerVideoCards.Length > index)
                    {
                        <ExamTakerVideoCard @ref="@_examTakerVideoCards[index]"
                                             ExamTakerName="@_testTakers[index].Id"
                                             OnBanExamTaker="() => BanTestTaker(_testTakers[index].Id)"
                                             OnToggleCamera="() => OnToggleCamera(_testTakers[index].Id)"
                                             OnToggleDesktop="() => OnToggleDesktop(_testTakers[index].Id)"
                                             CardsEachRow="@(NUM_COLS)" Banned="@(_testTakers[index].BanReason != null)"/>
                    }
                }
            </Row>
        }
    </ChildContent>
    <FooterRender>
    </FooterRender>
</BasicLayout>
<Modal Visible="_banModalVisible" Title="@("Ban exam taker: " + _banTakerName)" OnOk="BanTestTakerConfirm" OnCancel="BanTestTakerCancel">
    <ChildContent>
        <Paragraph>
            If you found the test taker is cheating, you can ban the test taker. Bannning will make exam takers 
            leave the exam immediatly. 
        </Paragraph>
        <Paragraph>
            <AutoComplete @bind-Value="_banReason" Placeholder="Specify the reason of banning" Options="@_banReasonOptions"/>
        </Paragraph>
    </ChildContent>
</Modal>