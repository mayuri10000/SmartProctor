@page "/"
@using Microsoft.AspNetCore.SignalR.Client
@layout LoginLayout
@inject ModalService Modal
@inject NavigationManager NavManager


<TestPrepareModal></TestPrepareModal>

@code
{
    private HubConnection _hubConnection;

    protected override async Task OnInitializedAsync()
    {
        _hubConnection = new HubConnectionBuilder()
            .WithUrl(NavManager.ToAbsoluteUri("/hub"))
            .Build();

        _hubConnection.On<string>("TestBack", TestBack);
            
        await _hubConnection.StartAsync();

        await _hubConnection.SendAsync("Test");
    }

    private void TestBack(string str)
    {
        Modal.Success(new ConfirmOptions()
        {
            Title = str
        });
    }
}
